= Install pre-requisites

== Using ArgoCD application to install RHOSO pre-requisites

Create an argocd application manifest to deploy all the prerequisites for the RHOSO control plane installation:

[source,bash,role=execute]
----
cat << EOF | oc apply -f -
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: pre-requisites-operators-installation
  namespace: openshift-gitops
spec:
  project: default
  source:
    repoURL: 'https://github.com/pnavarro/showroom_osp-on-ocp-advanced.git'
    targetRevision: HEAD
    path: content/files/manifests/pre-reqs-operators
  destination:
    server: 'https://kubernetes.default.svc'
    namespace: default
  syncPolicy:
    automated:
      prune: true
      selfHeal: false
    syncOptions:
    - CreateNamespace=true
EOF
----

Access the Argo CD console by logging in with the username admin and the password:

Extract the password from the admin user Secret:

[source,bash,role=execute]
----
argoPass=$(oc get secret/openshift-gitops-cluster -n openshift-gitops -o jsonpath='{.data.admin\.password}' | base64 -d)
echo $argoPass
----

Get the Route for the Argo CD/OpenShift GitOps server:
[source,bash,role=execute]
----
argoURL=$(oc get route openshift-gitops-server -n openshift-gitops -o jsonpath='{.spec.host}{"\n"}')
echo $argoURL
----

You should see that the pre-requisites-operators-installation is completed

Create a single instance of a *metallb* resource:

[source,bash,role=execute]
----
cat << EOF | oc apply -f -
apiVersion: metallb.io/v1beta1
kind: MetalLB
metadata:
  name: metallb
  namespace: metallb-system
spec:
  nodeSelector:
    node-role.kubernetes.io/worker: ""
EOF
----

Create instance of the *nmstate* operator:

[source,bash,role=execute]
----
cat << EOF | oc apply -f -
apiVersion: nmstate.io/v1
kind: NMState
metadata:
  name: nmstate
EOF
----

