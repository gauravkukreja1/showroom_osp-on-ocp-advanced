== Preparing RHOCP for RHOSP Network Isolation

== Using ArgoCD application to install configure networking

Create an argocd application manifest to deploy all the prerequisites for the RHOSO control plane installation:

[source,bash,role=execute]
----
cat << EOF | oc apply -f -
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: network-configuration
  namespace: openshift-gitops
spec:
  project: default
  source:
    repoURL: 'https://github.com/pnavarro/showroom_osp-on-ocp-advanced.git'
    targetRevision: HEAD
    path: content/files/manifests/network-configuration
  destination:
    server: 'https://kubernetes.default.svc'
    namespace: default
  syncPolicy:
    automated:
      prune: true
      selfHeal: false
    syncOptions:
    - CreateNamespace=true
EOF
----
Access the OpenShift Gitops console to check the deployment of the RHOSO operators.

If your cluster is RHOCP 4.14 or later and it has OVNKubernetes as the network back end, then you must enable global forwarding so that MetalLB can work on a secondary network interface.

Check the network back end used by your cluster:

[source,bash,role=execute]
----
$ oc get network.operator cluster --output=jsonpath='{.spec.defaultNetwork.type}'
----
If the back end is OVNKubernetes, then run the following command to enable global IP forwarding:

[source,bash,role=execute]
----
$ oc patch network.operator cluster -p '{"spec":{"defaultNetwork":{"ovnKubernetesConfig":{"gatewayConfig":{"ipForwarding": "Global"}}}}}' --type=merge
----